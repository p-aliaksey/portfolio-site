<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ - DevOps Portfolio</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <style>
        .architecture-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .architecture-diagram {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .component-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .component-card {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            border-left: 4px solid #007bff;
        }
        .component-card h3 {
            margin-top: 0;
            color: #007bff;
        }
        .port-info {
            background: #e9ecef;
            padding: 5px 10px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 0.9em;
            margin: 5px 0;
        }
        .flow-section {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        .flow-item {
            display: flex;
            align-items: center;
            margin: 10px 0;
            padding: 10px;
            background: white;
            border-radius: 5px;
            border-left: 3px solid #28a745;
        }
        .flow-arrow {
            margin: 0 10px;
            color: #6c757d;
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <a href="{{ url_for('index') }}" class="nav-logo">DevOps Portfolio</a>
            <div class="nav-menu">
                <a href="{{ url_for('index') }}" class="nav-link">–ì–ª–∞–≤–Ω–∞—è</a>
                <a href="{{ url_for('about') }}" class="nav-link">–û –ø—Ä–æ–µ–∫—Ç–µ</a>
                <a href="{{ url_for('monitoring') }}" class="nav-link">–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥</a>
                <a href="{{ url_for('architecture') }}" class="nav-link active">–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞</a>
                <a href="{{ url_for('metrics') }}" class="nav-link">–ú–µ—Ç—Ä–∏–∫–∏</a>
            </div>
        </div>
    </nav>

    <div class="architecture-container">
        <h1>üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞</h1>
        <p>–°—Ö–µ–º–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ DevOps Portfolio</p>

        <div class="architecture-diagram">
            <h2>–î–∏–∞–≥—Ä–∞–º–º–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã</h2>
            <div class="mermaid">
graph TB
    subgraph "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"
        U[üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å]
    end
    
    subgraph "Yandex Cloud"
        subgraph "VM Instance"
            subgraph "Docker Network"
                subgraph "Web Layer"
                    N[üåê Nginx<br/>Port 80<br/>Reverse Proxy]
                end
                
                subgraph "Application Layer"
                    A[üöÄ Flask App<br/>Port 8000<br/>Portfolio Site]
                end
                
                subgraph "Monitoring Layer"
                    P[üìä Prometheus<br/>Port 9090<br/>Metrics Collection]
                    G[üìà Grafana<br/>Port 3001<br/>Dashboards]
                end
                
                subgraph "Logging Layer"
                    L[üìù Loki<br/>Port 3100<br/>Log Aggregation]
                    PT[üìã Promtail<br/>Log Collection]
                end
            end
        end
        
        subgraph "Storage"
            GD[(üíæ Grafana Data<br/>SQLite)]
            LD[(üíæ Loki Data<br/>Filesystem)]
        end
    end
    
    subgraph "External Services"
        GH[üêô GitHub<br/>CI/CD]
        GHCR[üì¶ GHCR<br/>Container Registry]
    end
    
    %% User connections
    U -->|HTTP/HTTPS| N
    
    %% Nginx routing
    N -->|/| A
    N -->|/prometheus/| P
    N -->|/grafana/| G
    N -->|/loki/| L
    
    %% Monitoring connections
    P -->|Scrape| A
    P -->|Scrape| P
    G -->|Query| P
    G -->|Query| L
    
    %% Logging connections
    PT -->|Collect| A
    PT -->|Collect| N
    PT -->|Collect| P
    PT -->|Collect| G
    PT -->|Collect| L
    PT -->|Send| L
    
    %% Data storage
    G --> GD
    L --> LD
    
    %% CI/CD
    GH -->|Deploy| A
    GHCR -->|Pull| A
    
    %% Styling
    classDef userClass fill:#e1f5fe
    classDef webClass fill:#f3e5f5
    classDef appClass fill:#e8f5e8
    classDef monitorClass fill:#fff3e0
    classDef logClass fill:#fce4ec
    classDef storageClass fill:#f1f8e9
    classDef externalClass fill:#e0f2f1
    
    class U userClass
    class N webClass
    class A appClass
    class P,G monitorClass
    class L,PT logClass
    class GD,LD storageClass
    class GH,GHCR externalClass
            </div>
        </div>

        <div class="component-info">
            <div class="component-card">
                <h3>üåê Web Layer</h3>
                <p><strong>Nginx</strong> - Reverse proxy, –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤</p>
                <div class="port-info">Port 80 (HTTP), 443 (HTTPS)</div>
            </div>

            <div class="component-card">
                <h3>üöÄ Application Layer</h3>
                <p><strong>Flask App</strong> - –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ</p>
                <div class="port-info">Port 8000</div>
                <p>–§—É–Ω–∫—Ü–∏–∏: –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å, API, –º–µ—Ç—Ä–∏–∫–∏</p>
            </div>

            <div class="component-card">
                <h3>üìä Monitoring Layer</h3>
                <p><strong>Prometheus</strong> - –°–±–æ—Ä –º–µ—Ç—Ä–∏–∫</p>
                <div class="port-info">Port 9090</div>
                <p><strong>Grafana</strong> - –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∏ –¥–∞—à–±–æ—Ä–¥—ã</p>
                <div class="port-info">Port 3001</div>
            </div>

            <div class="component-card">
                <h3>üìù Logging Layer</h3>
                <p><strong>Loki</strong> - –ê–≥—Ä–µ–≥–∞—Ü–∏—è –ª–æ–≥–æ–≤</p>
                <div class="port-info">Port 3100</div>
                <p><strong>Promtail</strong> - –°–±–æ—Ä –ª–æ–≥–æ–≤ —Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤</p>
            </div>

            <div class="component-card">
                <h3>üîÑ CI/CD Pipeline</h3>
                <p><strong>GitHub Actions</strong> - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ</p>
                <p><strong>GHCR</strong> - –†–µ–µ—Å—Ç—Ä –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤</p>
                <p><strong>Ansible</strong> - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</p>
                <p><strong>Terraform</strong> - –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞–∫ –∫–æ–¥</p>
            </div>

            <div class="component-card">
                <h3>üíæ Storage</h3>
                <p><strong>Grafana Data</strong> - SQLite –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö</p>
                <p><strong>Loki Data</strong> - –§–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞</p>
            </div>
        </div>

        <div class="flow-section">
            <h2>üîÑ –ü–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö</h2>
            <div class="flow-item">
                <strong>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Ç—Ä–∞—Ñ–∏–∫:</strong>
                <span class="flow-arrow">‚Üí</span>
                Nginx ‚Üí Flask App
            </div>
            <div class="flow-item">
                <strong>–ú–µ—Ç—Ä–∏–∫–∏:</strong>
                <span class="flow-arrow">‚Üí</span>
                –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã ‚Üí Prometheus ‚Üí Grafana
            </div>
            <div class="flow-item">
                <strong>–õ–æ–≥–∏:</strong>
                <span class="flow-arrow">‚Üí</span>
                –í—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã ‚Üí Promtail ‚Üí Loki ‚Üí Grafana
            </div>
            <div class="flow-item">
                <strong>–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ:</strong>
                <span class="flow-arrow">‚Üí</span>
                GitHub ‚Üí Ansible ‚Üí Docker ‚Üí –°–µ—Ä–≤–∏—Å—ã
            </div>
        </div>

        <div class="flow-section">
            <h2>üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</h2>
            <div class="flow-item">
                <strong>Firewall:</strong> –ù–∞—Å—Ç—Ä–æ–µ–Ω —á–µ—Ä–µ–∑ Yandex Cloud Security Groups
            </div>
            <div class="flow-item">
                <strong>HTTPS:</strong> Let's Encrypt —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
            </div>
            <div class="flow-item">
                <strong>–ò–∑–æ–ª—è—Ü–∏—è:</strong> Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π —Å–µ—Ç–∏
            </div>
            <div class="flow-item">
                <strong>–î–æ—Å—Ç—É–ø:</strong> SSH –∫–ª—é—á–∏ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
            </div>
        </div>
    </div>

    <script>
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'default',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true
            }
        });
    </script>
</body>
</html>
